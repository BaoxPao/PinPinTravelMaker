<div class="container">
    <div class="row">
        <div class="col-md-4">
            <h1>註冊</h1>
            <form id="registerForm">
                <div class="mb-3">
                    <label for="name" class="form-label">暱稱:</label>
                    <input type="text" class="form-control" id="name" name="name" placeholder="請輸入暱稱，中英皆可" required>
                </div>
                <div class="mb-3">
                    <label for="email" class="form-label">Email:</label>
                    <input type="email" class="form-control" id="email" name="email" placeholder="pinpin@com.tw" required>
                </div>
                <div class="mb-3">
                    <label for="phone" class="form-label">電話:</label>
                    <input type="text" class="form-control" id="phone" name="phone" placeholder="09xx-xxx-xxx">
                </div>
                <div class="mb-3">
                    <label for="birthday" class="form-label">生日:</label>
                    <input type="date" class="form-control" id="birthday" name="birthday">
                </div>
                <div class="mb-3">
                    <label for="gender" class="form-label">性别:</label>
                    <select id="gender" name="gender" class="form-select">
                        <option value="0">不公開</option>
                        <option value="1">生理男</option>
                        <option value="2">生理女</option>
                    </select>
                </div>
                <div class="mb-3">
                    <label for="password" class="form-label">密碼:</label>
                    <input type="password" class="form-control" id="password" name="password" placeholder="請輸入8-16碼英數字" required>
                </div>
                <div class="mb-3">
                    <label for="passwordconfirm" class="form-label">確認密碼:</label>
                    <input type="password" class="form-control" id="passwordconfirm" name="passwordconfirm" placeholder="請再次輸入密碼" required>
                </div>
                <button type="submit" class="btn btn-secondary w-100">註冊</button>
            </form>
        </div>
    </div>
</div>

@section Scripts
{
    <script>
        var baseAddress = "https://localhost:7280";
        //document.getElementById('registerForm').addEventListener('submit', async function (event) {
        //event.preventDefault();
        $(document).ready(function () {
            $("#registerForm").on("submit", async function () {
                event.preventDefault();
                const name = $("#name").val();
                const email = $("#email").val();
                const phone = $("#phone").val();
                var birthday = $("#birthday").val();
                const gender = $("#gender").val();
                const password = $("#password").val();
                const passwordconfirm = $("#passwordconfirm").val();

                if (password !== passwordconfirm) {
                    alert('請再次確認密碼!');
                    return;
                }

                //若未選擇生日，則預設為"1970-01-01"
                if (!birthday) {
                    birthday = "1970-01-01";
                }

                try {
                    const response = await fetch(`${baseAddress}/api/Auth/Register`, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify({ name, email, phone, birthday, gender, password, passwordconfirm })
                    });

                    const result = await response.text();
                    alert(result);
                } catch (error) {
                    console.error('Error:', error);
                    alert('註冊失敗，請稍後再試');
                }
            });
        });


    </script>

}
